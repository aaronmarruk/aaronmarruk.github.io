<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Aaron Marr - Getting started with Clojure and Quil</title>
  <link rel="shortcut icon" href="/assets/images/favicon.ico">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="alternate" type="application/rss+xml" title="My Blog" href="/feed.xml">
  <link rel="stylesheet" href="/assets/css/highlight.css">
</head>
<body>

  <nav class="main-nav">
    
        <a href="/"> <span class="arrow">←</span> Home </a>
    

    
        <!-- <a href="/about">About </a> -->
    
    <a class="cta" href="/feed.xml">Subscribe</a>
</nav>

  

  <section id="wrapper" class="">
    <article class="post">
    <header>
        <h1>Getting started with Clojure and Quil</h1>
        <h2 class="headline">February 10, 2018</h2>
    </header>
    <section id="post-body">
        <p>I’ve been making an effort recently to learn some Generative Art / Design skills. Generative Art / Design is essentially the process of using algorithms as part of either art or design processes.</p>

<p>One of the most popular ways to get into this field is using the <a href="https://processing.org/">Processing</a> development environment.</p>

<p>While Processing is an excellent resource for learning the fundamental skills for creating generative art, I really don’t like using Java, which is the language used in the Processing IDE.
There are some alternatives to using Java with Processing – including a <a href="https://py.processing.org/">Python version</a>, and a browser-based <a href="http://processingjs.org/">Javascript version</a> – and recently I came across some interesting artists who use <a href="https://clojure.org/">Clojure</a> for generative art.</p>

<p>I’ve had a cursory interest in Clojure for the past couple years (I’ve tried to read the <a href="https://www.braveclojure.com/">Clojure for the brave and true</a> book a couple times) and interestingly there’s a port of Processing for Clojure by the way of <a href="https://github.com/quil/quil">Quil</a>. I decided to try it.</p>

<h3 id="install-java">Install Java</h3>
<p>The first thing you will need to do is install Java, if that’s not installed already. You can check you have Java installed by running:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java -version
</code></pre></div></div>

<p>If you are on a Mac you should already have that installed.</p>

<h3 id="install-leiningen">Install Leiningen</h3>

<p><a href="https://leiningen.org/">Leiningen</a> is Clojure’s build management tool. You should install that now:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl https://raw.githubusercontent.com/technomancy/leiningen/stable/bin/lein &gt; lein
sudo mkdir -p /usr/local/bin/
sudo mv lein /usr/local/bin/lein
sudo chmod a+x /usr/local/bin/lein
export PATH=$PATH:/usr/local/bin
</code></pre></div></div>

<p>Then run:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lein run
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Downloading Leiningen to /Users/aaron/.lein/self-installs/leiningen-2.8.1-standalone.jar now...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-100   618    0   618    0     0   1291      0 --:--:-- --:--:-- --:--:--  1292
  0 12.9M    0     0    0     0      0      0 --:--:--  0:00:0  3 12.9M    3  508k    0     0   254k      0  0:00:51  0:00:0 21 12.9M   21 2855k    0     0   952k      0  0:00:13  0:00:0 62 12.9M   62 8278k    0     0  2070k      0  0:00:06  0:00:0100 12.9M  100 12.9M    0     0  2901k      0  0:00:04  0:00:04 --:--:-- 3735k
Leiningen 2.8.1 on Java 1.8.0_131 Java HotSpot(TM) 64-Bit Server VM
</code></pre></div></div>

<h3 id="create-a-project">Create a project</h3>

<p>Once this has been done you will be able to use <code class="highlighter-rouge">Leiningen</code> to create a new Quil project.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lein new quil my-sketch
cd my-sketch
</code></pre></div></div>

<p>The <code class="highlighter-rouge">lein</code> command is used to scaffold new Clojure projects. You can see the result of that command by running <code class="highlighter-rouge">ls</code> inside the project directory:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ls
LICENSE		README.md 	project.clj	    src		target
</code></pre></div></div>

<p>Of interest is the <code class="highlighter-rouge">src</code> directory. This is where will will write our Clojure code. The <code class="highlighter-rouge">target</code> directory contains compiled Clojure code, meanwhile the <code class="highlighter-rouge">project.clj</code> file contains some configuration for the project.</p>

<p>Go ahead and run the new Quil project:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lein run
</code></pre></div></div>

<p>This throws an error: <code class="highlighter-rouge">No :main namespace specified in project.clj.</code>. This is trying to tell us that Clojure cannot find the main namespace (my-sketch.core), which is defined in <code class="highlighter-rouge">src/my_sketch/core.clj</code>. At the top of the file you should see the namespace declaration, something like:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ns my-sketch.core)
</code></pre></div></div>

<p>To fix the ‘no main namespace’ error, we need to add a line to <code class="highlighter-rouge">project.clj</code> to point Clojure at the main namespace which was generated by Leiningen (why it doesn’t do this automatically I don’t know). <code class="highlighter-rouge">project.clj</code> should look like:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(defproject my-sketch "0.1.0-SNAPSHOT"
  :description "FIXME: write description"
  :url "http://example.com/FIXME"
  :license {:name "Eclipse Public License"
            :url "http://www.eclipse.org/legal/epl-v10.html"}
  :dependencies [[org.clojure/clojure "1.8.0"]
                 [quil "2.6.0"]]
  :main my-sketch.core)
</code></pre></div></div>

<p>Now if you run the sketch you will see another error:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java.lang.Exception: Cannot find anything to run for: my-sketch.core
</code></pre></div></div>

<p>Essentially, when Clojure starts the application it looks for an entry point, a function called <code class="highlighter-rouge">-main</code>. We created the definition for this in <code class="highlighter-rouge">project.clj</code> but the actual <code class="highlighter-rouge">-main</code> function doesn’t exist yet. To fix this, I’ve create a new function, <code class="highlighter-rouge">-main</code> which wraps and calls the generated <code class="highlighter-rouge">defsketch</code> method in <code class="highlighter-rouge">src/my_sketch/core.clj</code>. The new function looks something like:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(defn -main 
  []
  (q/defsketch my-sketch
    :title "You spin my circle right round"
    :size [500 500]
    ; setup function called only once, during sketch initialization.
    :setup setup
    ; update-state is called on each iteration before draw-state.
    :update update-state
    :draw draw-state
    :features [:keep-on-top]
    ; This sketch uses functional-mode middleware.
    ; Check quil wiki for more info about middlewares and particularly
    ; fun-mode.
    :middleware [m/fun-mode]))
</code></pre></div></div>

<p>Now when running <code class="highlighter-rouge">lein run</code> the sketch loads without throwing any nasty looking errors in the console! Happy days.</p>

<h3 id="conclusion">Conclusion</h3>
<p>This has been a very quick peak at installing Clojure and it’s package manager Leiningen. I haven’t gone into too much detail about running sketches but we did fix a couple of initial bugs which are apparent when running the generated sketch files.</p>

<p>I’ve really enjoyed applying some basic knowledge of Clojure to my interests in generative art, and it’s interesting to hear what others have been doing with Clojure. I’m hoping to develop these skills further and who knows, I might actually create some nice art!</p>

    </section>
</article>
<footer id="post-meta" class="clearfix">
    <a href="http://twitter.com/aaronmarruk">
        <img class="avatar" src="/assets/images/avatar.png">
        <div>
            <span class="dark">Aaron Marr</span>
            <span>Full-stack web developer based in Cornwall</span>
        </div>
    </a>

    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=http://yourblog-domain.com/2018/getting-starting-with-clojure-and-quil/ - Getting started with Clojure and Quil by @aaronmarruk"><span class="icon-twitter"> Tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>
    </section>
</footer>

<!-- Disqus comments -->


<!-- Archive post list -->





  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/highlight.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXXX-X', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>



